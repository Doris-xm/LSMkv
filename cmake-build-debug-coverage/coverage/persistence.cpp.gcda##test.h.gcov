        -:    0:Source:E:/CppProject/dataStruct2023/LSMkv/test/test.h
        -:    0:Graph:E:\CppProject\dataStruct2023\LSMkv\cmake-build-debug-coverage\CMakeFiles\LSMkv_persist.dir\test\persistence.cpp.gcno
        -:    0:Data:E:\CppProject\dataStruct2023\LSMkv\cmake-build-debug-coverage\CMakeFiles\LSMkv_persist.dir\test\persistence.cpp.gcda
        -:    0:Runs:1
        -:    1:#pragma once
        -:    2:
        -:    3:#include <iostream>
        -:    4:#include <cstdint>
        -:    5:#include <string>
        -:    6:
        -:    7:#include "../header/kvstore.h"
        -:    8:
        -:    9:class Test {
        -:   10:protected:
        -:   11:    static const std::string not_found;
        -:   12:
        -:   13:    uint64_t nr_tests;
        -:   14:    uint64_t nr_passed_tests;
        -:   15:    uint64_t nr_phases;
        -:   16:    uint64_t nr_passed_phases;
        -:   17:
        -:   18:#define EXPECT(exp, got) expect<decltype(got)>((exp), (got), __FILE__, __LINE__)
        -:   19:    template<typename T>
    10329:   20:    void expect(const T &exp, const T &got,
        -:   21:                const std::string &file, int line)
        -:   22:    {
    10329:   23:        ++nr_tests;
    10329:   24:        if (exp == got) {
    10329:   25:            ++nr_passed_tests;
    10329:   26:            return;
        -:   27:        }
    #####:   28:        if (verbose) {
    #####:   29:            std::cerr << "TEST Error @" << file << ":" << line;
    #####:   30:            std::cerr << ", expected " << exp;
    #####:   31:            std::cerr << ", got " << got << std::endl;
        -:   32:        }
        -:   33:    }
------------------
_ZN4Test6expectIbEEvRKT_S3_RKNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEEi:
function _ZN4Test6expectIbEEvRKT_S3_RKNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEEi called 1536 returned 100% blocks executed 23%
     1536:   20:    void expect(const T &exp, const T &got,
        -:   21:                const std::string &file, int line)
        -:   22:    {
     1536:   23:        ++nr_tests;
     1536:   24:        if (exp == got) {
     1536:   24-block  0
branch  0 taken 1536 (fallthrough)
branch  1 taken 0
     1536:   25:            ++nr_passed_tests;
     1536:   26:            return;
     1536:   26-block  0
        -:   27:        }
    #####:   28:        if (verbose) {
    %%%%%:   28-block  0
branch  0 never executed
branch  1 never executed
    #####:   29:            std::cerr << "TEST Error @" << file << ":" << line;
    %%%%%:   29-block  0
call    0 never executed
call    1 never executed
call    2 never executed
call    3 never executed
    #####:   30:            std::cerr << ", expected " << exp;
call    0 never executed
call    1 never executed
    #####:   31:            std::cerr << ", got " << got << std::endl;
call    0 never executed
call    1 never executed
call    2 never executed
        -:   32:        }
        -:   33:    }
------------------
_ZN4Test6expectINSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEEEEvRKT_S9_RKS6_i:
function _ZN4Test6expectINSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEEEEvRKT_S9_RKS6_i called 8793 returned 100% blocks executed 29%
     8793:   20:    void expect(const T &exp, const T &got,
        -:   21:                const std::string &file, int line)
        -:   22:    {
     8793:   23:        ++nr_tests;
     8793:   24:        if (exp == got) {
     8793:   24-block  0
call    0 returned 8793
branch  1 taken 8793 (fallthrough)
branch  2 taken 0
     8793:   25:            ++nr_passed_tests;
     8793:   26:            return;
     8793:   26-block  0
        -:   27:        }
    #####:   28:        if (verbose) {
    %%%%%:   28-block  0
branch  0 never executed
branch  1 never executed
    #####:   29:            std::cerr << "TEST Error @" << file << ":" << line;
    %%%%%:   29-block  0
call    0 never executed
call    1 never executed
call    2 never executed
call    3 never executed
    #####:   30:            std::cerr << ", expected " << exp;
call    0 never executed
call    1 never executed
    #####:   31:            std::cerr << ", got " << got << std::endl;
call    0 never executed
call    1 never executed
call    2 never executed
        -:   32:        }
        -:   33:    }
------------------
        -:   34:
function _ZN4Test5phaseEv called 2 returned 100% blocks executed 86%
        2:   35:    void phase(void)
        -:   36:    {
        -:   37:        // Report
        2:   38:        std::cout << "  Phase " << (nr_phases+1) << ": ";
        2:   38-block  0
call    0 returned 2
call    1 returned 2
call    2 returned 2
        2:   39:        std::cout << nr_passed_tests << "/" << nr_tests << " ";
call    0 returned 2
call    1 returned 2
call    2 returned 2
call    3 returned 2
        -:   40:
        -:   41:        // Count
        2:   42:        ++nr_phases;
        2:   43:        if (nr_tests == nr_passed_tests) {
branch  0 taken 2 (fallthrough)
branch  1 taken 0
        2:   44:            ++nr_passed_phases;
        2:   45:            std::cout << "[PASS]" << std::endl;
        2:   45-block  0
call    0 returned 2
call    1 returned 2
        -:   46:        } else
    #####:   47:            std::cout << "[FAIL]" << std::endl;
    %%%%%:   47-block  0
call    0 never executed
call    1 never executed
        -:   48:
        2:   49:        std::cout.flush();
        2:   49-block  0
call    0 returned 2
        -:   50:
        -:   51:        // Reset
        2:   52:        nr_tests = 0;
        2:   53:        nr_passed_tests = 0;
        2:   54:    }
        -:   55:
function _ZN4Test6reportEv called 0 returned 0% blocks executed 0%
    #####:   56:    void report(void)
        -:   57:    {
    #####:   58:        std::cout << nr_passed_phases << "/" << nr_phases << " passed.";
    %%%%%:   58-block  0
call    0 never executed
call    1 never executed
call    2 never executed
call    3 never executed
    #####:   59:        std::cout << std::endl;
call    0 never executed
    #####:   60:        std::cout.flush();
call    0 never executed
        -:   61:
    #####:   62:        nr_phases = 0;
    #####:   63:        nr_passed_phases = 0;
    #####:   64:    }
        -:   65:
        -:   66:    class KVStore store;
        -:   67:    bool verbose;
        -:   68:
        -:   69:public:
function _ZN4TestC2ERKNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEEb called 1 returned 100% blocks executed 100%
        1:   70:    Test(const std::string &dir, bool v=true): store(dir), verbose(v)
        1:   70-block  0
call    0 returned 1
        -:   71:    {
        1:   72:        nr_tests = 0;
        1:   73:        nr_passed_tests = 0;
        1:   74:        nr_phases = 0;
        1:   75:        nr_passed_phases = 0;
        1:   76:    }
        -:   77:
function _ZN4Test10start_testEPv called 0 returned 0% blocks executed 0%
    #####:   78:    virtual void start_test(void *args = NULL)
        -:   79:    {
    #####:   80:        std::cout << "No test is implemented." << std::endl;
    %%%%%:   80-block  0
call    0 never executed
call    1 never executed
    #####:   81:    }
        -:   82:
        -:   83:};
        -:   84:const std::string Test::not_found = "";
